- unless defined?(level)
  - level = 0
- unless categories.nil? or categories.blank?
  - categories.each do |category|
    %li{ :rel => 'folder', :id => "category_#{category.id}" }
      = link_to category.name, '#', :class=>'big-icons'
      - unless category.children.empty? && category.blocks.blank?
        %ul
          - category.children.each do |child|
            = render :partial => 'admin/block_categories/list', :locals => { :page => page, :categories => [child], :level => (level + 1) }
          = render :partial => 'admin/block_categories/block', :locals => { :page => page }, :collection => category.blocks

- unless !defined?(blocks) or blocks.nil? or blocks.blank?
  = render :partial => 'admin/block_categories/block', :locals => { :page => page }, :collection => blocks
