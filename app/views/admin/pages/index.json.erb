{
'iTotalDisplayRecords': <%= @pages.total_entries || 0 %>,
'aaData': [
<% @pages.each do |page| %>
  <% 
    klass = page.active? ? 'see-on' : 'see-off'
    link_id = "page_#{page.id}"
    # status = [['published', 'published'], ['draft', 'draft'], ['to validate', 'to-validate']]
    status = [['published', 'published'], ['draft', 'draft']]
    page_clone = page.clone.attributes
    page_clone[:meta_info_attributes] = page.meta_info.clone.attributes if page.meta_info
  %>
  [
  '<%= content_tag(:div, '&nbsp;',:class => 'small-icons page')%>',
  '<%= escape_javascript content_tag(:div, link_to(page.title, [:admin, page]), :class => 'page-name') %>',
  '<%= page.url %>',
  '<%= page.section ? page.section.title : '-' %>',
  '<%= page.blocks.count %>',
  '<%= page.created_at.to_s(:slashed_fr) %>',
  '<%= escape_javascript(select_tag :status, options_for_select(status, page.active ? 'published' : 'draft'), :class => 'published') -%>
    <%= escape_javascript link_to('', new_admin_page_path(:page => page_clone), :class => 'small-icons duplicate-link') -%>
    <%= escape_javascript link_to('', [:edit, :admin, page], :class => 'small-icons edit-link') -%>
    <%= escape_javascript link_to_remote('', :url => [:admin, page],
      :method => :delete,
      :confirm => I18n.t('page.destroy.confirm').capitalize,
      :success => "removedataTablesRow('#destroy_#{link_id}')", 
      :html => {
      :class => 'small-icons destroy-link', :id => "destroy_#{link_id}"
    })
    -%>'
    ] <%= ',' unless @pages.last == page %>
<% end %>
]
}
