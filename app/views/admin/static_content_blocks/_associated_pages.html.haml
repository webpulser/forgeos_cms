- unless defined?(level)
  - level = 0
- categories.each do |category|
  %li.folder
    = link_to category.title, '#', :class=>'big-icons folder'
    - unless category.children.empty? && category.pages.blank?
      %ul
        - category.children.each do |child|
          = render :partial => 'associated_pages', :locals => { :categories => [child], :level => (level + 1) }
        - category.pages.each do |page|
          %li.page
            = link_to page.title + '<span></span>', '#', :class => "small-icons page"

- unless !defined?(pages) or pages.nil? or pages.blank?
  - pages.each do |page|
    %li.page
      = link_to page.title + '<span></span>', '#', :class => "small-icons page" 
